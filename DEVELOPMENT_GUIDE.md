# Vespera-Coze å¼€å‘æŒ‡å—ï¼šVibe Coding & Agent Teams æœ€ä½³å®è·µ

> æœ¬æŒ‡å—ç»“åˆ Anthropic "Effective Harnesses for Long-Running Agents" ç†å¿µï¼Œä¸ºå…¨æ‰˜ç®¡æ— ä»£ç /ä½ä»£ç åŒºå—é“¾å®‰å…¨å®¡è®¡é¡¹ç›®æä¾›æ ‡å‡†åŒ–å¼€å‘æµç¨‹ã€‚

## ğŸ¯ é¡¹ç›®æ ¸å¿ƒç†å¿µ

### 1. å¼€å‘ç†å¿µï¼šInitializer + Coding Agent åŒæ¨¡å¼

æ ¹æ® Anthropic å·¥ç¨‹å›¢é˜Ÿçš„ç ”ç©¶ï¼Œé•¿æ—¶é—´è¿è¡Œçš„ AI ä»£ç†åº”é‡‡ç”¨**åŒä»£ç†æ¶æ„**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Initializer Agent                        â”‚
â”‚  - é¦–æ¬¡è¿è¡Œè®¾ç½®ç¯å¢ƒ                                          â”‚
â”‚  - åˆ›å»ºåŠŸèƒ½æ¸…å• (Feature List)                               â”‚
â”‚  - ç”Ÿæˆ init.sh / progress.txt                              â”‚
â”‚  - Git åˆå§‹æäº¤                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Coding Agent                             â”‚
â”‚  - æ¯ä¸ªä¼šè¯åšå¢é‡è¿›å±•                                        â”‚
â”‚  - è¯»å–åŠŸèƒ½æ¸…å•é€‰æ‹©ä»»åŠ¡                                      â”‚
â”‚  - æ‰§è¡Œåæäº¤ Git + æ›´æ–°è¿›åº¦                                 â”‚
â”‚  - ç•™ä¸‹æ¸…æ™°çŠ¶æ€ä¾›ä¸‹æ¬¡ä¼šè¯                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æœ¬é¡¹ç›®å®è·µ**ï¼š
- `.github/workflows/init-db.yml` - Initializerï¼šä» Etherscan è·å–åˆçº¦æ•°æ®
- `.github/workflows/scan.yml` - Coding Agentï¼šæ‰§è¡Œæ‰«æä»»åŠ¡å¹¶ç”ŸæˆæŠ¥å‘Š

### 2. é¿å… AI å¹»è§‰çš„ç­–ç•¥

| ç­–ç•¥ | å®ç°æ–¹å¼ | æ–‡ä»¶ä½ç½® |
|------|---------|---------|
| **åŠŸèƒ½æ¸…å•é©±åŠ¨** | JSON æ ¼å¼åŠŸèƒ½æ¸…å•ï¼Œæ¯ä¸ªåŠŸèƒ½æ ‡è®°çŠ¶æ€ | `docs/features.json` |
| **Git ä½œä¸ºè®°å¿†** | æ¯æ¬¡å˜æ›´å¿…é¡»æäº¤ï¼Œé™„æè¿°æ€§æ¶ˆæ¯ | GitHub Actions |
| **è¿›åº¦æ–‡ä»¶è¿½è¸ª** | `claude-progress.txt` è®°å½•æ¯ä¸ªä¼šè¯å·¥ä½œ | å·¥ä½œæµ Artifact |
| **å¤šæ¨¡å‹éªŒè¯** | 3+ æ¨¡å‹äº¤å‰éªŒè¯å‡å°‘è¯¯æŠ¥ | `multi_model.go` |
| **ç«¯åˆ°ç«¯æµ‹è¯•** | æ¯ä¸ªåŠŸèƒ½å®Œæˆåè‡ªåŠ¨åŒ–æµ‹è¯• | `.github/workflows/` |

### 3. å…¨æ‰˜ç®¡å…ä»£ç æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å±‚ (No Code)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ GitHub Web   â”‚  â”‚ Vercel Dash  â”‚  â”‚ Supabase UI  â”‚       â”‚
â”‚  â”‚ ç‚¹å‡»è§¦å‘æ‰«æ  â”‚  â”‚ æŸ¥çœ‹å‰ç«¯æŠ¥å‘Š  â”‚  â”‚ æŸ¥çœ‹æ•°æ®åº“   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è‡ªåŠ¨åŒ–å±‚ (Low Code)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ GitHub Actions (CI/CD)                               â”‚   â”‚
â”‚  â”‚ - å®šæ—¶è§¦å‘ / æ‰‹åŠ¨è§¦å‘ / API è§¦å‘                      â”‚   â”‚
â”‚  â”‚ - è‡ªåŠ¨å®‰è£…ä¾èµ– / ç¼–è¯‘ / è¿è¡Œ                         â”‚   â”‚
â”‚  â”‚ - è‡ªåŠ¨ä¸Šä¼ æŠ¥å‘Šåˆ° Artifacts                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Self-Hosted LLM (139.224.113.163)                    â”‚   â”‚
â”‚  â”‚ - DeepSeek / GLM / Minimax / Kimi å¹¶è¡ŒéªŒè¯           â”‚   â”‚
â”‚  â”‚ - æ— éœ€ OpenAI API Keyï¼Œæˆæœ¬æ§åˆ¶                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å±‚ (Managed)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Supabase (PostgreSQL/SQLite)                        â”‚   â”‚
â”‚  â”‚   - åˆçº¦æ•°æ®æŒä¹…åŒ–    â”‚  â”‚   Etherscan API (V2)       â”‚   â”‚
â”‚  â”‚   - æ‰«æç»“æœå­˜å‚¨      â”‚  â”‚   - 94+ çƒ­é—¨åˆçº¦æ•°æ®       â”‚   â”‚
â”‚  â”‚   - è‡ªåŠ¨å¤‡ä»½         â”‚  â”‚   - æ¯å°æ—¶æ›´æ–°             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ æŠ€æœ¯æ ˆè¯¦è§£

### 1. æ— æœåŠ¡å™¨(Serverless)æ¶æ„

| ç»„ä»¶ | æœåŠ¡ | å…è´¹é¢åº¦ | ç”¨é€” |
|------|------|---------|------|
| **CI/CD** | GitHub Actions | 2000 åˆ†é’Ÿ/æœˆ | è‡ªåŠ¨æ‰«æã€æµ‹è¯•ã€éƒ¨ç½² |
| **æ•°æ®åº“** | Supabase | 500MB | åˆçº¦æ•°æ®ã€æ‰«æç»“æœ |
| **å‰ç«¯** | Vercel | 100GB æµé‡ | æ‰«ææŠ¥å‘Šå±•ç¤º (å¯é€‰) |
| **å­˜å‚¨** | GitHub Artifacts | 500MB | æŠ¥å‘Šæ–‡ä»¶ä¿ç•™7å¤© |
| **AI æ¨ç†** | Self-hosted LLM | è‡ªæœ‰æœåŠ¡å™¨ | åˆçº¦åˆ†æã€æ¼æ´æ£€æµ‹ |

### 2. å¤šæ¨¡å‹å¹¶è¡ŒéªŒè¯ (Multi-LLM Validation)

```go
// æ ¸å¿ƒå®ç°ï¼šmulti_model.go
var AvailableModels = []string{
    "deepseek-v3.2",  // é€»è¾‘æ¨ç†
    "glm-4.7",        // å®‰å…¨æ€§åˆ†æ
    "minimax-m2.1",   // æé€Ÿå“åº”
    "kimi-k2.5",      // é•¿æ–‡æœ¬å¤„ç†
}

// å¹¶è¡Œè°ƒç”¨æ‰€æœ‰æ¨¡å‹
func (m *MultiModelClient) ParallelAnalyze(contractCode string) (*MultiModelResult, error) {
    for _, model := range models {
        go func(m string) {
            result, err := m.AnalyzeWithModel(m, contractCode)
            // æ”¶é›†ç»“æœ...
        }(model)
    }
    // å…±è¯†æœºåˆ¶é™ä½è¯¯æŠ¥
    return m.aggregateResults(results)
}
```

**ä¼˜åŠ¿**ï¼š
- ä¸åŒæ¨¡å‹æœ‰ä¸åŒçš„"å¹»è§‰"æ¨¡å¼ï¼Œé€šè¿‡å…±è¯†æœºåˆ¶è¿‡æ»¤
- åˆ©ç”¨å·²æœ‰ GPU æœåŠ¡å™¨ï¼Œé›¶ API è´¹ç”¨
- å¯åŠ¨æ€åˆ‡æ¢æ¨¡å‹ï¼Œæ— éœ€æ”¹ä»£ç 

### 3. æ•°æ®åº“åŒæ¨¡å¼è®¾è®¡

```go
// è‡ªåŠ¨æ£€æµ‹å¹¶åˆ‡æ¢æ•°æ®åº“
func InitDatabase(cfg *Config) (*Database, error) {
    // ä¼˜å…ˆå°è¯• PostgreSQL (Supabase)
    db, err := NewPostgresDB(&cfg.Database)
    if err != nil {
        log.Printf("PostgreSQL å¤±è´¥: %v", err)
        // å›é€€åˆ° SQLite (æœ¬åœ°/GitHub Actions)
        log.Println("ğŸ”„ åˆ‡æ¢åˆ° SQLite...")
        return NewSQLiteDB("./data/vespera.db")
    }
    return db, nil
}
```

**åœºæ™¯é€‚é…**ï¼š
- **æœ¬åœ°å¼€å‘**ï¼šSQLiteï¼Œæ— éœ€é…ç½®
- **GitHub Actions**ï¼šSQLiteï¼Œæ— éœ€ç½‘ç»œ
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šSupabase PostgreSQLï¼Œäº‘ç«¯æŒä¹…åŒ–

## ğŸ”„ æ ‡å‡†åŒ–å¼€å‘æµç¨‹ (Vibe Coding)

### Step 1: åŠŸèƒ½è§„åˆ’ (Feature Planning)

æ‰€æœ‰åŠŸèƒ½å¿…é¡»ä»¥ JSON æ ¼å¼è®°å½•ï¼š

```json
{
  "features": [
    {
      "id": "etherscan-v2-migration",
      "description": "è¿ç§» Etherscan API ä» V1 åˆ° V2",
      "status": "completed",
      "priority": "high",
      "tests": ["api-connectivity", "rate-limiting"],
      "notes": "V1 äº 2025-08-15 å¼ƒç”¨"
    },
    {
      "id": "multi-model-validation",
      "description": "æ”¯æŒ DeepSeek/GLM/Minimax/Kimi å¹¶è¡ŒéªŒè¯",
      "status": "completed",
      "priority": "high",
      "tests": ["consensus-algorithm", "fallback-mechanism"]
    }
  ]
}
```

**å·¥å…·**ï¼š
```bash
# åˆå§‹åŒ–æ–°åŠŸèƒ½
./scripts/add-feature.sh "æ–°åŠŸèƒ½æè¿°"

# æ ‡è®°åŠŸèƒ½å®Œæˆ
./scripts/complete-feature.sh "feature-id"
```

### Step 2: ç¯å¢ƒé…ç½® (Environment Setup)

**GitHub Secrets é…ç½®**ï¼ˆä¸€æ¬¡æ€§ï¼‰ï¼š

```bash
# ä½¿ç”¨ GitHub CLI è‡ªåŠ¨åŒ–é…ç½®
gh secret set SUPABASE_HOST --body "your-host.supabase.co"
gh secret set SUPABASE_PASSWORD --body "your-password"
gh secret set AI_API_KEY --body "api"
gh secret set AI_BASE_URL --body "http://139.224.113.163:8317/v1"
gh secret set ETHERSCAN_API_KEY --body "KDWBKZIF6EPGDWJTSP5A5I5RI248AK7Z4W"
```

### Step 3: å¢é‡å¼€å‘ (Incremental Development)

**æ¯ä¸ª Coding Session çš„å›ºå®šæµç¨‹**ï¼š

1. **è¯»å–è¿›åº¦**ï¼ˆ30ç§’ï¼‰
   ```bash
   git log --oneline -10
   cat claude-progress.txt
   cat features.json | jq '.features[] | select(.status == "pending")'
   ```

2. **é€‰æ‹©ä»»åŠ¡**ï¼ˆ1åˆ†é’Ÿï¼‰
   - é€‰æ‹©æœ€é«˜ä¼˜å…ˆçº§çš„ pending åŠŸèƒ½
   - ç¡®è®¤ä¾èµ–åŠŸèƒ½å·²å®Œæˆ

3. **ç¼–å†™ä»£ç **ï¼ˆä¸»è¦æ—¶é—´ï¼‰
   - éµå¾ª Go é¡¹ç›®ç»“æ„
   - æ·»åŠ å•å…ƒæµ‹è¯•
   - ä¿æŒå‘åå…¼å®¹

4. **éªŒè¯æµ‹è¯•**ï¼ˆ2åˆ†é’Ÿï¼‰
   ```bash
   go test ./...
   ./vespera -test-db
   ```

5. **æäº¤å˜æ›´**ï¼ˆ1åˆ†é’Ÿï¼‰
   ```bash
   git add -A
   git commit -m "feat: å®ŒæˆåŠŸèƒ½X

   - ä¿®æ”¹1
   - ä¿®æ”¹2
   - æµ‹è¯•é€šè¿‡

   Co-Authored-By: Claude"
   git push origin main
   ```

6. **æ›´æ–°è¿›åº¦**ï¼ˆ1åˆ†é’Ÿï¼‰
   ```bash
   echo "$(date): å®ŒæˆåŠŸèƒ½X" >> claude-progress.txt
   ```

### Step 4: è‡ªåŠ¨åŒ–éƒ¨ç½²

**GitHub Actions å·¥ä½œæµ**ï¼š

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run Tests
        run: go test ./...
      - name: Build
        run: go build -o vespera ./cmd/vespera
      - name: Test Database
        run: ./vespera -test-db
```

## ğŸ¤– AI Agent Teams åä½œæ¨¡å¼

### 1. Agent è§’è‰²å®šä¹‰

| Agent | èŒè´£ | è§¦å‘æ¡ä»¶ | å·¥å…· |
|-------|------|---------|------|
| **Initializer** | ç¯å¢ƒåˆå§‹åŒ–ã€æ•°æ®è·å– | é¦–æ¬¡è¿è¡Œ / æ•°æ®åº“ä¸ºç©º | `init-db.yml` |
| **Scanner** | æ‰§è¡Œæ‰«æã€ç”ŸæˆæŠ¥å‘Š | å®šæ—¶ / æ‰‹åŠ¨è§¦å‘ | `scan.yml` |
| **Analyzer** | æ·±åº¦åˆ†æã€æ¼æ´éªŒè¯ | å‘ç°é«˜å±æ¼æ´æ—¶ | `analyze.yml` (å¯é€‰) |
| **Reporter** | ç”ŸæˆæŠ¥å‘Šã€å‘é€é€šçŸ¥ | æ‰«æå®Œæˆ | å†…ç½®åœ¨ Scanner |

### 2. Agent é—´é€šä¿¡æœºåˆ¶

**é€šè¿‡ GitHub Artifacts å…±äº«æ•°æ®**ï¼š

```
Initializer (94 ä¸ªåˆçº¦)
    â”‚
    â–¼ ä¸Šä¼  Artifact: vespera-database-eth
    â”‚
Scanner (è¯»å– Artifact)
    â”‚
    â–¼ æ‰§è¡Œæ‰«æ
    â”‚
    â–¼ ä¸Šä¼  Artifact: scan-report-{id}
    â”‚
Reporter (ä¸‹è½½æŠ¥å‘Š)
    â”‚
    â–¼ å‘é€é‚®ä»¶/Slack é€šçŸ¥
```

**é€šè¿‡æ•°æ®åº“å…±äº«çŠ¶æ€**ï¼š

```sql
-- åˆçº¦è¡¨
CREATE TABLE ethereum (
    address VARCHAR(42) PRIMARY KEY,
    scan_result JSONB,        -- Agent é—´ä¼ é€’ç»“æœ
    scan_time TIMESTAMP,      -- é¿å…é‡å¤æ‰«æ
    status VARCHAR(20)        -- pending / scanning / completed / failed
);
```

### 3. é¿å…å†²çªçš„æœºåˆ¶

1. **Git é”æœºåˆ¶**ï¼ˆGit LFS Lockï¼‰
   ```bash
   git lfs lock data/vespera.db
   # ä¿®æ”¹æ•°æ®åº“
   git lfs unlock data/vespera.db
   ```

2. **çŠ¶æ€æ£€æŸ¥**ï¼ˆWorkflow Concurrencyï¼‰
   ```yaml
   concurrency:
     group: ${{ github.workflow }}-${{ github.ref }}
     cancel-in-progress: false  # ç­‰å¾…å‰ä¸€æ¬¡å®Œæˆ
   ```

3. **åŠŸèƒ½æ¸…å•é”å®š**ï¼ˆFeature Lockï¼‰
   ```json
   {
     "id": "feature-123",
     "status": "in_progress",
     "locked_by": "agent-001",
     "locked_at": "2026-02-17T10:00:00Z"
   }
   ```

## ğŸ›¡ï¸ é˜²å¹»è§‰æ£€æŸ¥æ¸…å•

åœ¨æ¯æ¬¡æäº¤å‰ï¼Œè¿è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š

```bash
#!/bin/bash
# scripts/pre-commit-check.sh

echo "ğŸ§ª è¿è¡Œé˜²å¹»è§‰æ£€æŸ¥..."

# 1. æ£€æŸ¥åŠŸèƒ½æ¸…å•æ˜¯å¦å­˜åœ¨
if [ ! -f "docs/features.json" ]; then
    echo "âŒ é”™è¯¯: åŠŸèƒ½æ¸…å•ä¸å­˜åœ¨"
    exit 1
fi

# 2. æ£€æŸ¥æ‰€æœ‰æµ‹è¯•æ˜¯å¦é€šè¿‡
go test ./... || exit 1

# 3. æ£€æŸ¥æ•°æ®åº“è¿æ¥
./vespera -test-db || exit 1

# 4. æ£€æŸ¥ä»£ç é£æ ¼
gofmt -d . | grep -q "^" && echo "âŒ ä»£ç æ ¼å¼é”™è¯¯" && exit 1

# 5. æ£€æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²
grep -r "apikey\|api_key\|password" --include="*.go" . | grep -v "// " && echo "âŒ å¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯" && exit 1

echo "âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡"
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ

### 1. GitHub Actions ä¼˜åŒ–

```yaml
# ç¼“å­˜ç­–ç•¥
- uses: actions/cache@v4
  with:
    path: |
      ~/.cache/go-build
      ~/go/pkg/mod
      data/vespera.db
    key: ${{ runner.os }}-go-${{ hashFiles('**/go.sum') }}
    restore-keys: |
      ${{ runner.os }}-go-
```

### 2. æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

```go
// æ·»åŠ ç´¢å¼•
func (d *Database) AddIndexes() {
    d.DB.Exec("CREATE INDEX IF NOT EXISTS idx_scan_time ON ethereum(scan_time)")
    d.DB.Exec("CREATE INDEX IF NOT EXISTS idx_isopensource ON ethereum(isopensource)")
}
```

### 3. API é€Ÿç‡é™åˆ¶å¤„ç†

```go
// è‡ªåŠ¨é€€é¿ç­–ç•¥
func (e *EtherscanAPI) makeRequest(params url.Values) (*EtherscanResponse, error) {
    for attempt := 0; attempt < 3; attempt++ {
        resp, err := e.client.Get(url)
        if err != nil {
            time.Sleep(time.Duration(attempt) * time.Second) // æŒ‡æ•°é€€é¿
            continue
        }
        return resp, nil
    }
    return nil, fmt.Errorf("max retries exceeded")
}
```

## ğŸš€ æ‰©å±•å¼€å‘è·¯çº¿å›¾

### Phase 1: æ ¸å¿ƒåŠŸèƒ½ (å·²å®Œæˆ âœ…)
- [x] Etherscan V2 API é›†æˆ
- [x] å¤šæ¨¡å‹å¹¶è¡ŒéªŒè¯
- [x] SQLite/PostgreSQL åŒæ¨¡å¼
- [x] GitHub Actions è‡ªåŠ¨åŒ–

### Phase 2: å¢å¼ºåŠŸèƒ½ (è¿›è¡Œä¸­)
- [ ] Vercel å‰ç«¯å±•ç¤ºæŠ¥å‘Š
- [ ] Slack/é‚®ä»¶é€šçŸ¥é›†æˆ
- [ ] å¤šé“¾æ”¯æŒ (BSC/Polygon/Arbitrum)
- [ ] å®æ—¶ç›‘å¬æ¨¡å¼ (Mode 3)

### Phase 3: å•†ä¸šåŒ– (è§„åˆ’ä¸­)
- [ ] ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] è®¢é˜…è®¡è´¹é›†æˆ (Stripe)
- [ ] API æœåŠ¡å¼€æ”¾
- [ ] é«˜çº§åˆ†æä»ªè¡¨æ¿

## ğŸ“š å‚è€ƒèµ„æ–™

1. **Anthropic - Effective Harnesses for Long-Running Agents**
   - https://www.anthropic.com/engineering/effective-harnesses-for-long-running-agents
   - æ ¸å¿ƒç†å¿µï¼šInitializer + Coding Agent åŒæ¨¡å¼

2. **GitHub Actions æ–‡æ¡£**
   - https://docs.github.com/en/actions
   - æœ€ä½³å®è·µï¼šç¼“å­˜ã€å¹¶å‘æ§åˆ¶ã€Artifact ç®¡ç†

3. **Supabase æ–‡æ¡£**
   - https://supabase.com/docs
   - PostgreSQL å…è´¹æ‰˜ç®¡æ–¹æ¡ˆ

4. **Etherscan API V2**
   - https://docs.etherscan.io/v2-migration
   - è¿ç§»æŒ‡å—å’Œæœ€ä½³å®è·µ

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2026-02-17
**ä½œè€…**: Claude + jssyxd (Vibe Coding)
**è®¸å¯**: MIT
